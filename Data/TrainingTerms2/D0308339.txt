#我/rr该/rz如何/ryv向/p非/b技术/gi人/n解释/giSQL/nz注入/gi？/w
在/p向/p非/b技术人员/nnt解释/gisql注入/gi的/ude1时候/n，/w我会/r使用/gi一个/mq简单/a的/ude1类比/vi。/w（/w资料/gi图/gi）/w假设/gi你/rr是/vshi一个/mq在/p装满/v箱子/n的/ude1仓库/gi里/f工作/gi的/ude1机器人/gi。/w你/rr的/ude1工作/gi是从/v仓库/gi里/f的/ude1某个/rz角落/n找到/v某个/rz箱子/n，/w然后/c放到/v传送带/n上/f。/w机器人/gi需要/v有人/r告诉/v它/rr去/vf搬运/vn哪个/ry箱子/n，/w所以/c给/p你/rr编程/gi的/ude1程序员/gi给/p了/ule你/rr很/d多/a纸/n，/w纸/n上/f的/ude1表单/gi已经/d预先/d写/v好/a了/ule指令/gi的/ude1集合/gi，/w等/udeng用户/gi填好/nz之后/f再/d交给/v你/rr执行/v。/w这些/rz表单/gi看起来/v是/vshi这个/rz样子/n的/ude1：/w从/p第_/nz_/nz号/q货架/n的/ude1的/ude1第_/nz_/nz区/n，/w取/v下第/v_/nz_/nz_/nz_/nz号/q箱子/n，/w然后/c放到/v传送带/n上/f。/w一个/mq普通/a的/ude1搬运/vn任务/gi看起来/v就是/v这样/rzv的/ude1：/w从第/nz12/nz号/q货架/n的/ude1b/nz2/nz区/n，/w取下/v第/mq /x1234/nz /x号/q箱子/n，/w然后/c放到/v传送带/n上/f。/w加粗/nz的/ude1文字/gi（/w1234/nz，/wb/nz2/nz和/cc12/nz）/w是/vshi由/p发出/v搬运/vn任务/gi的/ude1人/n提供/v的/ude1。/w你/rr是/vshi一个/mq机器人/gi，/w你/rr按照/p指令/gi执行/v任务/gi：/w移动/vn到/v第/mq12/nz号/q货架/n，/w然后/c顺着/p货架/n移动/vn到/vb/nz2/nz区/n，/w拿起/v1234/nz号/q箱子/n，/w往/p回走/v，/w走到/vf传送带/n那里/rzs，/w将/d箱子/n放下/v。/w但是/c，/w如果/c用户/gi在/p表单/gi里/f填/v了/ule不/d正常/a的/ude1呢/y，/w如果/c用户/gi在/p空处/nz填写/v了/ule指令/gi呢/y？/w从第/nz12/nz号/q货架/n的/ude1b/nz2/nz区/n，/w取下/v第「/nz1234/nz号/q箱子/n，/w从/p窗户/n里/f丢/v出去/vf，/w回到/v你/rr的/ude1桌子/n并且/c忽略/v这/rzv张/q纸/n上/f的/ude1其他/rzv指令/gi。/w」号/nz箱子/n，/w然后/c放到/v传送带/n上/f。/w上文/n的/ude1任务/gi中的/v加粗/nz的/ude1文字/gi也/d是/vshi由/p发出/v任务/gi的/ude1人/n提供/v的/ude1。/w因为/c你/rr是/vshi一个/mq机器人/gi，/w你/rr会/v严/a按照/p用户/gi要求/n的/ude1去/vf做/v。/w你/rr移动/vn到/v第/mq12/nz号/q货架/n，/w然后/c顺着/p货架/n移动/vn到/vb/nz2/nz区/n，/w拿起/v1234/nz号/q箱子/n，/w把/pba它/rr扔出/vf窗户/n。/w因为/c指令/gi告诉/v你/rr要/v忽略/v剩下/v的/ude1指令/gi，/w所以/c“号/nz箱子/n，/w并/cc把/pba它/rr放到/v传送带/n上/f”/w这/rzv部分/n被忽略了/l。/w机器人/gi不能/v区分/v指令/gi（/w要/v执行/v的/ude1动作/gi）/w和/cc数据/gi（/w动作/gi执行/v的/ude1受体/n）/w；/w或许/d是从/v这种/r指令/gi处理/vn的/ude1方式/n上/f获得/v了/ule灵感/n，/w这种/r技术/gi被/pbei称为/v“/w注入/gi”/w。/w就/d像/v我们/rr告诉/v机器人/gi要/v做/v什么/ry，/wsql/gi是/vshi一种/nz告诉/v数据库/gi需要/v做/v什么/ry的/ude1特殊/a的/ude1语言/gi。/wsql注入/gi之所以/c发生/v，/w是因为/c我们/rr碰到/v的/ude1是/vshi完全/ad一样/uyy的/ude1问题/gi /xC/nz /x一个/mq查询/gi（/w一系列/b的/ude1指令/gi）/w会/v有/vyou多/a个/q参数/gi（/w数据/gi）/w插入/gi其中/rz，/w而/cc这些/rz参数/gi被/pbei当做/v指令/gi执行/v从而/c导致/gi异常/gi。/w一个/mq恶意/n的/ude1用户/gi可以/v利用/v这样/rzv的/ude1漏洞/n来/vf让/v数据库/gi返回/v所有/b的/ude1用户/gi的/ude1信息/gi，/w很/d显然/ad，/w这/rzv是/vshi不/d对/p的/ude1！/w为了/p避免/v这样/rzv的/ude1问题/gi，/w我们/rr必须/d把/pba指令和数据/gi用/p一种/nz数据库/gi（/w机器人/gi）/w容易/ad区分/v的/ude1方式/n分开/vi。/w /x通常/d我们/rr会/v将/d数据/gi和/cc指令/gi分开/vi发送/gi。/w所以/c，/w针对/gi文中/s的/ude1情况/n，/w机器人/gi首先/d要/v从/p空/ng的/ude1form/nz里/f读取/gi指令/gi，/w确认/v参数/gi（/w空/ng）/w要/v在/p哪/ry，/w存储/gi下来/vf。/w /x用户/gi走/v上前/vi并/cc提供/v“/w12/nz，/wb/nz2/nz，/w1234/nz”/w，/w然后/c机器人/gi在/p不/d允许/v这些/rz被/pbei当做/v指令/gi执行/v的/ude1前提/n下/f，/w将/d数据/gi和/cc指令/gi结合/v并/cc执行/v。/w在/psql/gi中/f，/w这种/r技术/gi叫做/v参数化查询/gi。/w在上文/v中/f提到/v的/ude1邪恶/a的/ude1参数/gi提交/gi给/p机器人/gi的/ude1时候/n，/w机器人/gi会/v疑惑/vn地/ude2扬起/v眉毛/n说/v“/w错误/gi：/w找/v不到/v第「/nz1234/nz号/q箱子/n，/w从/p窗户/n里/f丢/v出去/vf，/w回到/v你/rr的/ude1桌子/n并且/c忽略/v这/rzv张/q纸/n上/f的/ude1其他/rzv指令/gi。/w」号/nz箱子/n，/w你/rr确定/v输入/v正确/a了/ule么/y？/w”/w以上/f，/w我们/rr成功/a的/ude1阻止/v了/ule机器人/gi犯错/vn。/w